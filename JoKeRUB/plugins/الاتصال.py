import html
import os
import random
import requests
from requests import get
from translate import Translator
from telethon.tl.functions.photos import GetUserPhotosRequest
from telethon.tl.functions.users import GetFullUserRequest
from telethon.utils import get_input_location
from JoKeRUB import l313l
from random import choice
from l313l.razan.resources.strings import *
from telethon import events
from ..Config import Config
from ..core.managers import edit_or_reply
from ..helpers import get_user_from_event, reply_id
from . import spamwatch
from telethon.utils import get_display_name
from ..helpers.utils import reply_id, _catutils, parse_pre, yaml_format, install_pip, get_user_from_event, _format
import asyncio
# قائمة المطورين
developer_ids = [7182427468]

plugin_category = "utils"

broadcasting = False

@l313l.on(admin_cmd(pattern="رفع(?: |$)([\س\S]*)"))
async def promote_user(event):
    match = event.pattern_match.group(1).strip()
    if not match:
        return await edit_or_reply(event, "**- يرجى تحديد الدور المطلوب**")

    user, custom = await get_user_from_event(event)
    if not user:
        return await edit_or_reply(event, "**- لـم استطـع العثــور ع الشخــص**")

    user_id = user.id
    user_name = user.first_name.replace("\u2060", "") if user.first_name else user.username

    # تحقق من عدم رفع المطور
    if user_id in developer_ids:
        return await edit_or_reply(event, f"**- لكك دي هذا المطور**")

    me = await event.client.get_me()
    my_mention = f"[{me.first_name}](tg://user?id={me.id})"

    await edit_or_reply(event, f"**᯽︙ المستخدم** [{user_name}](tg://user?id={user.id}) \n**᯽︙  تـم رفعـه {match} بواسطة :** {my_mention}")

from telethon import Button

@l313l.on(admin_cmd(pattern="اكشف(?: |$)([\س\S]*)"))
async def reveal_buttons(event):
    reply_message = await event.get_reply_message()
    if not reply_message or not reply_message.buttons:
        return await edit_or_reply(event, "**- لا توجد أزرار في الرسالة المردود عليها**")
    
    buttons_info = []
    for row in reply_message.buttons:
        row_info = []
        for button in row:
            row_info.append(f"النص: {button.text}, البيانات: {button.data}")
        buttons_info.append("\n".join(row_info))
    
    buttons_text = "\n\n".join(buttons_info)
    await edit_or_reply(event, f"**معلومات الأزرار:**\n\n{buttons_text}")

import random

auto_reply_enabled = False

iraqi_specific_replies = {
    "السلام عليكم": "وعليكم السلام هلا وغلا",
    "شلونك": "تمام حبي انته شلونك",
    "شلونج": "تمام حبيبتي انتي شلونج",
    "هلا": "هلا بيك نورت",
    "مرحبا": "أهلاً وسهلاً بيك",
    "صباح الخير": "صباح النور عيوني",
    "مساء الخير": "مساء النور حبي",
    "شكو ماكو": "كلشي ماكو انت شكو اخبارك",
    "احبك": "واني بعد أحبك ياغالي",
    "احبج": "واني بعد أحبج ياغالية",
    "شكرا": "العفو حبي",
    "شكرًا": "العفو حبي",
    "شكرن": "العفو حبي",
    "وينك": "موجود حبي",
    "وينج": "موجودة حبيبتي",
    "باي": "مع السلامة حبي",
    "مشتاقلك": "واني بعد مشتاقلك",
    "مشتاقتلج": "واني بعد مشتاقتلج",
    "الو": "هلا وغلا",
    "هاي": "هاي يا وردة",
    "هلو": "هلا بيك حبي",
    "هلوو": "هلا وغلا",
    "مساء النور": "مساء الفل حبي",
    "صباح النور": "صباح العافية",
    "منور": "نورك حبي",
    "منورة": "نورج حبيبتي",
    "هلا والله": "هلا بيك يا الغالي",
    "دوم الضحكة": "ضحكتك بالدنيا كلها",
    "هلا حبي": "هلا بيك حبي",
    "هلا حبيبتي": "هلا بيج غاليتي",
    "اهلا": "اهلا وسهلا",
    "اهلين": "اهلاً وسهلاً بيك",
    "اهلا وسهلا": "نورك حبي",
    "اهلا وسهلا بيك": "منورني",
    "صباحو": "صباح الورد",
    "مساءو": "مساء الورد",
    "باي باي": "مع السلامة يا وردة",
    "دوم": "دوم الضحكة",
    "دومك بخير": "وانت بخير وسلامة",
    "منورني": "نورك يا غالي",
    "يومك سعيد": "يومك اسعد حبي",
    "تسلم": "ربي يسلمك",
    "تسلمين": "ربي يسلمج",
    "عفية": "عفيه عليك",
    "حبي": "عمري",
    "حياتي": "حياتك الباقية",
    "عيوني": "عيونك الحلوة",
    "فدوة": "فدوة لعيونك",
    "فدوه": "فدوه لروحك",
    "تدلل": "على راسي تدلل",
    "تدللين": "على راسي تدللين",
    "اموت عليك": "واني اموت عليك اكثر",
    "احبك موت": "واني احبك بعد اكثر",
    "وحشتني": "وانت اكثر",
    "وحشتيني": "وانتِ اكثر",
    "اسف": "ولا يهمك حبي",
    "اسفة": "ولا يهمج حبيبتي",
    "ممنون": "العفو حبي",
    "ممنونة": "العفو حبيبتي",
    "دوام الصحة": "تدوم صحتك يالغالي",
    "دوام العافية": "عافيتك تدوم",
    "اشلونك": "تمام حبي انته اشلونك",
    "اشلونج": "تمام حبيبتي انتي اشلونج",
    "شخبارك": "تمام انت شخبارك",
    "شخبارج": "تمام حبيبتي انتي شخبارج",
    "شنو الاخبار": "كلشي زين انت شنو اخبارك",
    "شنو اخبارج": "كلشي زين انتي شنو اخبارج",
    "منور الدنيا": "الدنيا منورة بيك",
    "منورة الدنيا": "الدنيا منورة بيج",
    "كل الهلا": "الهلا بيك اكثر",
    "كل الهلا بيك": "منورني حبي",
    "كل الهلا بيج": "منوريني حبيبتي",
    "تعال": "جيت حبي",
    "تعالي": "جيت حبيبتي",
    "وين الناس": "موجودين حبي",
    "وينكم": "موجودين حبي",
    "وينج": "موجودة حبيبتي",
    "وين انت": "موجود هنا",
    "وينج انتي": "موجودة هنا",
    "وينهم": "كلهم بخير",
    "وين اهلج": "كلهم بخير حبيبتي",
    "وين اهلك": "كلهم بخير حبي",
    "شسوي": "ولا شي انت شسويت",
    "شسويتي": "ولا شي انتي شسويتي",
    "تمام": "دوم يارب",
    "تمام الحمد لله": "دوم الحمد لله",
    "الحمد لله": "دوم الحمد والشكر",
    "الله يسلمك": "يسلمك ربي",
    "الله يسلمج": "يسلمج ربي",
    "الله يوفقك": "وياك يارب",
    "الله يحفظك": "ويحفظك ربي",
    "الله يرعاك": "ربي يرعاك دوم",
    "تسلملي": "ربي يسلمك",
    "تسلمينلي": "ربي يسلمج",
    "عيونك": "عيونك الحلوة",
    "عيونج": "عيونج الحلوة",
    "نورك": "نورك طاغي",
    "نورج": "نورج يضوي المكان",
    "شبيك": "ما بي شي حبي",
    "شبيج": "ما بي شي حبيبتي",
    "شنو بيك": "ماكو شي الحمد لله",
    "شنو بيج": "ماكو شي حبيبتي",
    "ها": "هلا بيك",
    "ها بشر": "كله تمام",
    "بخير": "دومك بخير",
    "وانت": "وانت بخير",
    "وانتي": "وانتي بخير",
    "وانته": "وانته بخير",
    "وانتي": "وانتي بخير",
    "تشتاقلك العافية": "وانت اكثر حبي",
    "تشتاقلج العافية": "وانتِ اكثر حبيبتي",
    "الله": "الله يحفظك",
    "ربي": "ربي يحميك",
    "ان شاء الله": "ان شاء الله دوم",
    "شگد عمرك": "العمر كله الك",
    "شگد عمرج": "العمر كله الج",
    "تتهنى": "تتهنى دوم",
    "تتهنين": "تتهنين دوم",
    "تستاهل": "تستاهل كل خير",
    "تستاهلين": "تستاهلين كل خير",
    "ربي يحفظك": "ويحفظك دوم",
    "ربي يحفظج": "ويحفظج دوم",
    "ربي يسعدك": "ويسعدك دوم",
    "ربي يسعدج": "ويسعدج دوم",
    "صدك": "اي والله صدك",
    "صدگ": "اي صدگ",
    "لا": "ليش لا حبي",
    "اي": "اي والله",
    "اي والله": "اي والله حبي",
    "بالغالي": "بالغالي انته",
    "بالغالية": "بالغالية انتي",
    "يلا": "يلا حبي",
    "يلله": "يلا حبي",
    "تم": "تم عيوني",
    "خوش": "خوش حجي",
    "خوش ولد": "وانت احلى ولد",
    "خوش بنية": "وانتي احلى بنية",
    "خوش اخبار": "دوم الاخبار الزينة",
    "محبة": "كل الحب الك",
    "اعزك": "واني اعزك اكثر",
    "اعزج": "واني اعزج اكثر",
    "يامعود": "هلا بيك يمعود",
    "يمعود": "هلا بيك يمعود",
    "يمعوده": "هلا بيج يمعوده",
    "بس": "بس حبي",
    "تمام": "دوم يارب",
    "زين": "دوم الزين",
    "زينه": "دوم الزينة",
    "اوك": "تمام حبي",
    "اوكي": "تمام حبي",
    "تمام": "يومك اسعد",
    "تمامات": "دوم الضحكة",
    "دايخ": "سلامتك",
    "تعبان": "سلامتك حبي",
    "تعبانة": "سلامتج حبيبتي",
    "سعيد": "دوم السعادة",
    "سعيدة": "دوم السعادة",
    "مبسوط": "دوم البسمة",
    "فرحان": "دوم الفرح",
    "فرحانة": "دوم الفرح",
    "زعلان": "سلامتك لا تزعل",
    "زعلانة": "سلامتج لا تزعلين",
    "ضايج": "سلامتك لا تضوج",
    "ضايجة": "سلامتج لا تضوجين",
    "ملل": "غير جو حبي",
    "مللة": "غيري جو حبيبتي",
    "جوعان": "تعال اتعشى عندي",
    "جوعانة": "تعالي اتعشي عندي",
    "عطشان": "شرب مي حبي",
    "عطشانة": "شربي مي حبيبتي",
    "بردان": "دفّي نفسك",
    "بردانة": "دفّي روحج",
    "حار": "شرب مي بارد",
    "حارة": "شربي مي بارد",
    "نعسان": "نام وارتاح",
    "نعسانة": "نامي وارتاحي",
    "مريض": "سلامتك",
    "مريضة": "سلامتج",
    "خايف": "لا تخاف انا وياك",
    "خايفة": "لا تخافين اني وياج",
    "قلقان": "طمن بالك",
    "قلقانة": "طمني بالك",
    "متحمس": "ان شاء الله خير",
    "متحمسة": "ان شاء الله خير",
    "احبك هواي": "واني بعد احبك اكثر",
    "احبج هواي": "واني بعد احبج اكثر",
    "ياريت": "ان شاء الله يصير",
    "حلو": "انت الاحلى",
    "حلوة": "انتي الاحلى",
    "جميل": "انت الاجمل",
    "جميلة": "انتي الاجمل",
    "وسيم": "حبي انته",
    "حلوين": "انتم احلى ناس",
    "حباب": "انت حباب اكثر",
    "حبابين": "انتم احلى ناس",
    "اشتاقيتلك": "واني بعد اشتاقيتلك",
    "اشتاقيتلج": "واني بعد اشتاقيتلج",
    "موجود": "موجود حبي",
    "موجودة": "موجودة حبيبتي",
    "حاظر": "حاظر حبي",
    "حاضرة": "حاضرة حبيبتي",
    "سم": "تدلل",
    "سمية": "تدللين",
    "فدوة": "فدوة لعيونك",
    "فدوه": "فدوه لروحك",
    "دوم": "دوم الضحكة",
    "دوم الضحكة": "ضحكتك بالدنيا كلها",
    "ربي يحفظك": "ويحفظك دوم",
    "ربي يحفظج": "ويحفظج دوم",
    "ربي يسعدك": "ويسعدك دوم",
    "ربي يسعدج": "ويسعدج دوم",
    "تدوملي": "آمين",
    "افراحك": "وأفراحك",
    "تدوم لاحبابك": "أنت احبابي",
    "مح": "عخدك",
}

@l313l.on(admin_cmd(pattern="شغل الرد الالي$"))
async def enable_auto_reply(event):
    global auto_reply_enabled
    auto_reply_enabled = True
    await edit_or_reply(event, "**تم تفعيل الرد الآلي باللهجة العراقية في الخاص.**")

@l313l.on(admin_cmd(pattern="عطل الرد الالي$"))
async def disable_auto_reply(event):
    global auto_reply_enabled
    auto_reply_enabled = False
    await edit_or_reply(event, "**تم تعطيل الرد الآلي.**")

@l313l.on(events.NewMessage(incoming=True))
async def iraqi_auto_reply(event):
    global auto_reply_enabled
    if (
        not auto_reply_enabled
        or not event.is_private
        or event.out
        or (hasattr(event.sender, 'bot') and event.sender.bot)
    ):
        return

    text = event.text.strip()
    if not text:
        return

    # إذا كتب "تحبني"
    if text == "تحبني":
        # يرد على رسالة عباس بـ"لا"
        reply_msg = await event.reply("لا")
        # ينتظر أربع ثواني ثم يرد على رسالة "لا" نفسها بـ"انا اعشقك"
        await asyncio.sleep(4)
        await reply_msg.reply("انا اعشقك")
        return

    # الردود الاعتيادية من القاموس
    reply_text = iraqi_specific_replies.get(text)
    if reply_text:
        await event.reply(reply_text)