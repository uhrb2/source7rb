import html
import os
import random
import requests
from requests import get
from translate import Translator
from telethon.tl.functions.photos import GetUserPhotosRequest
from telethon.tl.functions.users import GetFullUserRequest
from telethon.utils import get_input_location
from JoKeRUB import l313l
from random import choice
from l313l.razan.resources.strings import *
from telethon import events
from ..Config import Config
from ..core.managers import edit_or_reply
from ..helpers import get_user_from_event, reply_id
from . import spamwatch
from telethon.utils import get_display_name
from ..helpers.utils import reply_id, _catutils, parse_pre, yaml_format, install_pip, get_user_from_event, _format
import asyncio
# قائمة المطورين
developer_ids = [7182427468]

plugin_category = "utils"

broadcasting = False

@l313l.on(admin_cmd(pattern="رفع(?: |$)([\س\S]*)"))
async def promote_user(event):
    match = event.pattern_match.group(1).strip()
    if not match:
        return await edit_or_reply(event, "**- يرجى تحديد الدور المطلوب**")

    user, custom = await get_user_from_event(event)
    if not user:
        return await edit_or_reply(event, "**- لـم استطـع العثــور ع الشخــص**")

    user_id = user.id
    user_name = user.first_name.replace("\u2060", "") if user.first_name else user.username

    # تحقق من عدم رفع المطور
    if user_id in developer_ids:
        return await edit_or_reply(event, f"**- لكك دي هذا المطور**")

    me = await event.client.get_me()
    my_mention = f"[{me.first_name}](tg://user?id={me.id})"

    await edit_or_reply(event, f"**᯽︙ المستخدم** [{user_name}](tg://user?id={user.id}) \n**᯽︙  تـم رفعـه {match} بواسطة :** {my_mention}")

from telethon import Button

@l313l.on(admin_cmd(pattern="اكشف(?: |$)([\س\S]*)"))
async def reveal_buttons(event):
    reply_message = await event.get_reply_message()
    if not reply_message or not reply_message.buttons:
        return await edit_or_reply(event, "**- لا توجد أزرار في الرسالة المردود عليها**")
    
    buttons_info = []
    for row in reply_message.buttons:
        row_info = []
        for button in row:
            row_info.append(f"النص: {button.text}, البيانات: {button.data}")
        buttons_info.append("\n".join(row_info))
    
    buttons_text = "\n\n".join(buttons_info)
    await edit_or_reply(event, f"**معلومات الأزرار:**\n\n{buttons_text}")

import random

auto_reply_enabled = False

# قائمة 250 رد عراقي منوّع
iraqi_random_replies = [
    "هلا بيك حبي", "نورتني برسالتك", "يا هلا وغلا", "شكو ماكو", "كل الهلا بيك", "دومك بخير إن شاء الله", "الله يحفظك",
    "تدلل أمرني", "عيني إلك", "بخدمتك بأي وقت", "يا بعد راسي", "تسلملي يا غالي", "نورك طاغي اليوم", "يا زين الناس",
    "دمت بخير وسلامة", "يمعود اشتاقيتلك", "الله يديمك النا", "عفية عليك", "يا حلو الطلة", "يا أبو الغيرة",
    "الله يرضى عليك", "تسلم يا طيب", "منورني يا وردة", "الله يحفظك من كل شر", "يا غالي", "يا حنين", "يا وردة",
    "يا عسل", "يا باشا", "يا ملك", "يا بطل", "يا مبدع", "كل شي على خاطرك", "دير بالك على نفسك", "تتهنى يا عمري",
    "عاشت أيامك", "ربي يوفقك", "فدوة لقلبك", "يا طيب", "يا ابن الأصول", "يا أبو الطيب", "كثر الله خيرك",
    "تسلملي يا أخوي", "دوم السعادة عليك", "الله يجعل أيامك كلها أفراح", "يا غالي على قلبي", "أحب سماع صوتك",
    "مشكور يا طيب", "ما تقصر", "الله يبارك بيك", "سلامي إلك", "تحياتي يا طيب", "الله يديم المحبة", "الله يجبر خاطرك",
    "عاشت أيدك على الكلام الحلو", "الله يكرمك", "عين الله ترعاك", "فدوة الروحك", "ربي يحفظلك أحبابك", "دوماً بالقلب",
    "يا عزيز وغالي", "أحبك بالزايد", "عفية حبي", "كل الهلا والورد", "صحتين وعافية", "دوم الضحكة", "شرفني تواصلك",
    "حب وود", "تسلم العين", "انت الذهب الأصيل", "الله يوفقك ويرزقك", "دوم الخير عليك", "أبد ما ننساك", "ربي يسعدك",
    "البيت بيتك", "أهلين وسهلين", "دوام الصحة والعافية", "شمسك منورة", "الكرم منك", "انته حيل طيب", "أحلى ناس",
    "أنت الزين", "ربي يبعد عنك كل شر", "الله يحفظلك أهلك", "يسعد مساك", "يسعد صباحك", "دوم التوفيق", "ربي يكرمك ويزيدك",
    "فدوى لعيونك", "تستاهل الخير", "كل يوم وانت بخير", "عمي انته", "قلبي وياك", "ربي يحقق أمانيك", "أحلى تحية إلك",
    "دوم الأفراح", "الله لا يحرمنا منك", "تسلم الروح", "كلشي بخاطرك يصير", "أحلى ناس والله", "انته على راسي",
    "يا محترم", "ربي يفتحها بوجهك", "أحلى طلة", "ربي يرضى عنك", "تسلم يا أصيل", "شكرًا يا وردة", "ربي ينور دربك",
    "أنت دوم الأول", "أنت فخر", "ربي يرزقك من حيث لا تحتسب", "أنت السند", "كل الهلا بأهل العراق", "أحلى سلام إلك",
    "أحلى فدوة", "أحلى هلا", "أحلى مساء", "أحلى صباح", "أحلى ورود", "أحلى أيام", "دوم النجاح", "دوم المحبة",
    "يا عز الناس", "أنت دوم بالقلب", "أنته تاج راسي", "دوم الفرح عليك", "أنته بالبال دايمًا", "دوم بخير يا صاحبي",
    "ربي يرزقك الصحة والعافية", "كل الهلا بأحلى ناس", "ماكو منك اثنين", "انت حيل غالي", "أحلى أخ", "أحلى أخت",
    "أحلى صديق", "أحلى صديقة", "ربي يسعدك دنيا وآخرة", "يا روحي", "يا نور العين", "أحلى قلب", "دومك بخير حبي",
    "سلمت يمناك", "سلمت روحك", "ربي يديمك لنا", "أحلى ضحكة", "دوم الأمان", "دوم الرضا", "أحلى كلام", "ربي يوفقك",
    "ربي يكتبلك الخير", "ربي يحفظك ويخليك", "دومك منور", "الله يرزقك السعادة", "ربي يعينك", "الله يفرح قلبك",
    "دومك مبتسم", "أحلى أيام العمر", "ربي يسعدك ويحفظك", "أحلى مسا عليكم", "أحلى صباح عليكم", "الله ينور قلبك",
    "أحلى ناس بالحياة", "أنت الغالي دومًا", "الله يحفظ أحبابك", "ربي يسعد أوقاتك", "أحلى وردة", "أحلى زهرة",
    "ربي يحميك", "دوم الصحة عليك", "ربي يوفقك وين ما تروح", "كل الهلا بأهل الكرم", "أحلى طيب", "ربي يرزقك الخير",
    "دوم النجاح والتوفيق", "ربي يرزقك راحة البال", "أحلى أمنيات", "دوم الأمل", "أحلى فرحة", "ربي يجبر خاطرك",
    "دوم الهنا", "ربي يريح قلبك", "أحلى أيام العمر", "دومك مسرور", "أحلى ورد", "دومك بخير وسلامة", "الله يجعل أيامك حلوة",
    "ربي ينور مستقبلك", "أحلى ناس دومًا", "ربي يرضى عنك", "دوم السعادة والفرح", "أحلى رفعة راس", "ربي يزيدك خير",
    "أحلى مبروك", "دومك بخير يا غالي", "الله يوفقك ويحقق أمانيك", "دوم الصحة والسلامة", "أحلى أيام وأحلى سنين",
    "ربي يعطيك العافية", "ربي يسعد قلوبكم", "أحلى ناس بالدنيا", "الله يحفظك وين ما تكون", "دوم الضحكة والسعادة",
    "أحلى ناس وأحلى طيبين", "ربي يرفع قدرك", "الله يرزقك الرضا", "دوم النور في طريقك", "أحلى دعوة", "ربي يحفظك دومًا",
    "أحلى ناس وأحلى أخلاق", "ربي يفرح قلبك دومًا", "دومك بخير يا ورد", "ربي يبعد عنك الحزن", "دوم الفرح بقلبك",
    "أحلى أيام العمر", "ربي يبارك بعمرك", "دومك بخير يا عزيز", "الله ينور دربك", "ربي يرزقك السعادة الدائمة",
    "أحلى وقت وياكم", "دوم الخير وياك", "أحلى جمعة", "ربي يكتبلك التوفيق في حياتك", "أحلى ناس وأحلى عشرة",
    "دومك بخير وسرور", "ربي يهنّي قلبك", "أحلى ناس دومًا بجانبي", "ربي يجعل كل أيامك فرح", "دومك بخير يا غالي",
    "الله يسعد أيامك", "ربي يحقق أمنياتك", "أحلى أيام العمر", "دومك طيب وحنون", "ربي يرحم والديك", "دومك بخير وأمان",
    "أحلى دعوة من القلب", "دومك بخير وسعادة", "ربي يعطيك كل خير", "أحلى ناس معايا", "ربي يديم محبتكم", "دومك بخير يا صاحب القلب الطيب",
    "أحلى ناس بالدنيا كلها", "ربي يسعد حياتك", "دومك بخير يا وردة", "أحلى أيام العمر معاكم", "دومك بخير وسلامة يا غالي",
    "ربي يسعد كل أوقاتك", "دومك بخير يا أغلى الناس", "أحلى ناس بالدنيا كلها", "ربي يبارك فيك ويزيدك خير",
    "دومك بخير يا أحلى ناس", "ربي يحقق كل أمنياتك", "أحلى وقت وياكم دومًا", "دومك بخير يا أحلى وردة", "ربي يرفع قدرك دومًا",
    "أحلى ناس بالدنيا كلها دومًا", "دومك بخير يا أخوي", "ربي يوفقك في كل خطوة", "أحلى ناس وأطيب قلوب", "دومك بخير يا أطيب الناس",
    "ربي يسعدك في الدنيا والآخرة", "أحلى ناس بالدنيا", "دومك بخير يا أطيب القلوب", "ربي يبارك فيك دومًا", "أحلى ناس وأحلى عشرة دومًا"
]

# ردود محددة لعبارات مشهورة
iraqi_specific_replies = {
    "السلام عليكم": "وعليكم السلام هلا وغلا",
    "شلونك": "تمام حبي انته شلونك",
    "اشلونك": "تمام حبي انته اشلونك",
    "شلونج": "تمام حبيبتي، انتي شلونج؟",
    "اشلونج": "تمام حبيبتي، انتي اشلونج؟",
    "هلا": "هلا بيك نورت",
    "هاي": "هاي يا وردة",
    "مرحبا": "أهلاً وسهلاً بيك",
    "الو": "هلا وغلا",
    "مساء الخير": "مساء النور حبي",
    "صباح الخير": "صباح النور عيوني",
    "شكو ماكو": "كلشي ماكو انت شكو اخبارك",
    "باي": "مع السلامة حبي",
    "تمام": "دوم يارب",
    "شكرا": "العفو حبي",
    "شكرًا": "العفو حبي",
    "شكر": "العفو حبي",
    "احبك": "واني بعد أحبك ياغالي",
    "شكرن": "العفو حبي",
    "ثانكس": "العفو حبي",
    "مشتاقلك": "واني بعد مشتاقلك",
    "وينك": "موجود حبي",
    "هلاو": "هلا بيك حبي",
    "احبج": "واني بعد أحبج ياغالية",
    "تمام الحمد لله": "دوم الحمد لله",
    "شلون حياتك": "كلشي تمام وانت شلونك",
    "وين صرت": "موجود هنا وياك",
    "وين الناس": "موجودين حبي",
    "مساء النور": "مساء الورد يا وردة",
    "صباح النور": "صباح الفل والورد",
    "منور": "نورك حبي",
    "منورة": "نورج حبيبتي",
    "هلا والله": "هلا بيك يا الغالي",
    "دوم الضحكة": "ضحكتك بالدنيا كلها",
    "هلا حبي": "هلا بيك حبي",
    "هلا حبيبتي": "هلا بيج غاليتي",
    "اهلا": "اهلا وسهلا",
    "اهلين": "اهلاً وسهلاً بيك",
    "اهلا وسهلا": "نورك حبي",
    "اهلا وسهلا بيك": "منورني",
    "صباحو": "صباح الورد",
    "مساءو": "مساء الورد",
    "باي باي": "مع السلامة يا وردة",
    "دوم": "دوم الضحكة",
    "دومك بخير": "وانت بخير وسلامة",
    "منورني": "نورك يا غالي",
    "يومك سعيد": "يومك اسعد حبي",
    "تسلم": "ربي يسلمك",
    "تسلمين": "ربي يسلمج",
    "عفية": "عفيه عليك",
    "حبي": "عمري",
    "حياتي": "حياتك الباقية",
    "عيوني": "عيونك الحلوة"
}

@l313l.on(admin_cmd(pattern="شغل الرد الالي$"))
async def enable_auto_reply(event):
    global auto_reply_enabled
    auto_reply_enabled = True
    await edit_or_reply(event, "**تم تفعيل الرد الآلي باللهجة العراقية في الخاص.**")

@l313l.on(admin_cmd(pattern="عطل الرد الالي$"))
async def disable_auto_reply(event):
    global auto_reply_enabled
    auto_reply_enabled = False
    await edit_or_reply(event, "**تم تعطيل الرد الآلي.**")

@l313l.on(events.NewMessage(incoming=True))
async def iraqi_auto_reply(event):
    global auto_reply_enabled
    if not auto_reply_enabled or not event.is_private or event.out:
        return
    text = event.text
    if not text:
        return
    txt = text.lower().strip()
    # رد خاص إذا وجد تطابق، أو رد عشوائي من القائمة
    reply_text = None
    for key, value in iraqi_specific_replies.items():
        if key in txt:
            reply_text = value
            break
    if not reply_text:
        reply_text = random.choice(iraqi_random_replies)
    await event.reply(reply_text)