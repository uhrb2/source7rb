import html
import os
import random
from telethon.tl.types import EmojiStatusEmpty
import requests
from requests import get
from translate import Translator
from telethon.tl.functions.photos import GetUserPhotosRequest
from telethon.tl.functions.users import GetFullUserRequest
from telethon.utils import get_input_location
from JoKeRUB import l313l
from random import choice
from l313l.razan.resources.strings import *
from telethon import events
from ..Config import Config
from ..core.managers import edit_or_reply
from ..helpers import get_user_from_event, reply_id
from . import spamwatch
from telethon.utils import get_display_name
from ..helpers.utils import reply_id, _catutils, parse_pre, yaml_format, install_pip, get_user_from_event, _format
import asyncio
# قائمة المطورين
import json
import os

developer_ids = [7182427468]
ranks_file = "ranks.json"

forbidden_words = [
    "بوت", "بوته", "بوتة", "تكرار", "سورس", "سورسه", "مطورة", "مطوري" , "المطور" "مطور", "سورسة", "سورسي"
]

def load_ranks():
    if os.path.exists(ranks_file):
        with open(ranks_file, "r", encoding="utf-8") as f:
            return json.load(f)
    return {}

def save_ranks(ranks):
    with open(ranks_file, "w", encoding="utf-8") as f:
        json.dump(ranks, f, ensure_ascii=False)

async def set_rank(user_id, rank):
    ranks = load_ranks()
    ranks[str(user_id)] = rank
    save_ranks(ranks)

def get_rank(user_id):
    ranks = load_ranks()
    return ranks.get(str(user_id))

def contains_forbidden(text):
    text = text.lower()
    return any(word in text for word in forbidden_words)

@l313l.on(admin_cmd(pattern="رفع(?: |$)([\s\S]*)"))
async def promote_user(event):
    text = event.pattern_match.group(1).strip()
    sender = await event.client.get_entity(event.sender_id)

    if event.is_reply:
        reply_msg = await event.get_reply_message()
        user = await event.client.get_entity(reply_msg.sender_id)
        rank = text
    else:
        if " " in text:
            user_part, rank = text.split(" ", 1)
            try:
                user = await event.client.get_entity(user_part)
            except Exception:
                return await edit_or_reply(event, "**- لـم استطـع العثــور ع الشخــص**")
        else:
            return await edit_or_reply(event, "**- يرجى تحديد العضو والرتبة مثل: .رفع [بالرد] مطور**")

    if not rank:
        return await edit_or_reply(event, "**- يرجى تحديد الرتبة بعد الأمر**")

    # تحقق كلمات محظورة (إلا لو كان المطور هو من يرفع)
    if contains_forbidden(rank) and event.sender_id not in developer_ids:
        return await edit_or_reply(event, "لا يمكنك رفع لأنك لست مطورا ياغبي ياعضو يازق")

    user_id = user.id
    user_name = user.first_name.replace("\u2060", "") if user.first_name else user.username

    if user_id in developer_ids:
        return await edit_or_reply(event, f"**- لكك دي هذا المطور**")

    await set_rank(user_id, rank)

    me = await event.client.get_me()
    my_mention = f"[{me.first_name}](tg://user?id={me.id})"

    await edit_or_reply(
        event,
        f"**᯽︙ المستخدم** [{user_name}](tg://user?id={user.id}) \n**᯽︙  تـم رفعـه {rank} بواسطة :** {my_mention}"
    )

from telethon import Button

@l313l.on(admin_cmd(pattern="اكشف(?: |$)([\س\S]*)"))
async def reveal_buttons(event):
    reply_message = await event.get_reply_message()
    if not reply_message or not reply_message.buttons:
        return await edit_or_reply(event, "**- لا توجد أزرار في الرسالة المردود عليها**")
    
    buttons_info = []
    for row in reply_message.buttons:
        row_info = []
        for button in row:
            row_info.append(f"النص: {button.text}, البيانات: {button.data}")
        buttons_info.append("\n".join(row_info))
    
    buttons_text = "\n\n".join(buttons_info)
    await edit_or_reply(event, f"**معلومات الأزرار:**\n\n{buttons_text}")


developer_ids = [7182427468]
plugin_category = "utils"
broadcasting = False

# الرد الالي
auto_reply_enabled = False
current_auto_reply_dialect = None  # 'iraqi' or 'saudi'

iraqi_specific_replies = {
    "السلام عليكم": "وعليكم السلام هلا وغلا",
    "شلونك": "تمام حبي انته شلونك",
    "شلونج": "تمام حبيبتي انتي شلونج",
    "هلا": "هلا بيك نورت",
    "مرحبا": "أهلاً وسهلاً بيك",
    "صباح الخير": "صباح النور عيوني",
    "مساء الخير": "مساء النور حبي",
    "شكو ماكو": "كلشي ماكو انت شكو اخبارك",
    "احبك": "واني بعد أحبك ياغالي",
    "احبج": "واني بعد أحبج ياغالية",
    "شكرا": "العفو حبي",
    "شكرًا": "العفو حبي",
    "شكرن": "العفو حبي",
    "وينك": "موجود حبي",
    "وينج": "موجودة حبيبتي",
    "باي": "مع السلامة حبي",
    "مشتاقلك": "واني بعد مشتاقلك",
    "مشتاقتلج": "واني بعد مشتاقتلج",
    "الو": "هلا وغلا",
    "هاي": "هاي يا وردة",
    "هلو": "هلا بيك حبي",
    "هلوو": "هلا وغلا",
    "مساء النور": "مساء الفل حبي",
    "صباح النور": "صباح العافية",
    "منور": "نورك حبي",
    "منورة": "نورج حبيبتي",
    "هلا والله": "هلا بيك يا الغالي",
    "دوم الضحكة": "ضحكتك بالدنيا كلها",
    "هلا حبي": "هلا بيك حبي",
    "هلا حبيبتي": "هلا بيج غاليتي",
    "اهلا": "اهلا وسهلا",
    "اهلين": "اهلاً وسهلاً بيك",
    "اهلا وسهلا": "نورك حبي",
    "اهلا وسهلا بيك": "منورني",
    "صباحو": "صباح الورد",
    "مساءو": "مساء الورد",
    "باي باي": "مع السلامة يا وردة",
    "دوم": "دوم الضحكة",
    "دومك بخير": "وانت بخير وسلامة",
    "منورني": "نورك يا غالي",
    "يومك سعيد": "يومك اسعد حبي",
    "تسلم": "ربي يسلمك",
    "تسلمين": "ربي يسلمج",
    "عفية": "عفيه عليك",
    "حبي": "عمري",
    "حياتي": "حياتك الباقية",
    "عيوني": "عيونك الحلوة",
    "فدوة": "فدوة لعيونك",
    "فدوه": "فدوه لروحك",
    "تدلل": "على راسي تدلل",
    "تدللين": "على راسي تدللين",
    "اموت عليك": "واني اموت عليك اكثر",
    "احبك موت": "واني احبك بعد اكثر",
    "وحشتني": "وانت اكثر",
    "وحشتيني": "وانتِ اكثر",
    "اسف": "ولا يهمك حبي",
    "اسفة": "ولا يهمج حبيبتي",
    "ممنون": "العفو حبي",
    "ممنونة": "العفو حبيبتي",
    "دوام الصحة": "تدوم صحتك يالغالي",
    "دوام العافية": "عافيتك تدوم",
    "اشلونك": "تمام حبي انته اشلونك",
    "اشلونج": "تمام حبيبتي انتي اشلونج",
    "شخبارك": "تمام انت شخبارك",
    "شخبارج": "تمام حبيبتي انتي شخبارج",
    "شنو الاخبار": "كلشي زين انت شنو اخبارك",
    "شنو اخبارج": "كلشي زين انتي شنو اخبارج",
    "منور الدنيا": "الدنيا منورة بيك",
    "منورة الدنيا": "الدنيا منورة بيج",
    "كل الهلا": "الهلا بيك اكثر",
    "كل الهلا بيك": "منورني حبي",
    "كل الهلا بيج": "منوريني حبيبتي",
    "تعال": "جيت حبي",
    "تعالي": "جيت حبيبتي",
    "وين الناس": "موجودين حبي",
    "وينكم": "موجودين حبي",
    "وينج": "موجودة حبيبتي",
    "وين انت": "موجود هنا",
    "وينج انتي": "موجودة هنا",
    "وينهم": "كلهم بخير",
    "وين اهلج": "كلهم بخير حبيبتي",
    "وين اهلك": "كلهم بخير حبي",
    "شسوي": "ولا شي انت شسويت",
    "شسويتي": "ولا شي انتي شسويتي",
    "تمام": "دوم يارب",
    "تمام الحمد لله": "دوم الحمد لله",
    "الحمد لله": "دوم الحمد والشكر",
    "الله يسلمك": "يسلمك ربي",
    "الله يسلمج": "يسلمج ربي",
    "الله يوفقك": "وياك يارب",
    "الله يحفظك": "ويحفظك ربي",
    "الله يرعاك": "ربي يرعاك دوم",
    "تسلملي": "ربي يسلمك",
    "تسلمينلي": "ربي يسلمج",
    "عيونك": "عيونك الحلوة",
    "عيونج": "عيونج الحلوة",
    "نورك": "نورك طاغي",
    "نورج": "نورج يضوي المكان",
    "شبيك": "ما بي شي حبي",
    "شبيج": "ما بي شي حبيبتي",
    "شنو بيك": "ماكو شي الحمد لله",
    "شنو بيج": "ماكو شي حبيبتي",
    "ها": "هلا بيك",
    "ها بشر": "كله تمام",
    "بخير": "دومك بخير",
    "وانت": "وانت بخير",
    "وانتي": "وانتي بخير",
    "وانته": "وانته بخير",
    "وانتي": "وانتي بخير",
    "تشتاقلك العافية": "وانت اكثر حبي",
    "تشتاقلج العافية": "وانتِ اكثر حبيبتي",
    "الله": "الله يحفظك",
    "ربي": "ربي يحميك",
    "ان شاء الله": "ان شاء الله دوم",
    "شگد عمرك": "العمر كله الك",
    "شگد عمرج": "العمر كله الج",
    "تتهنى": "تتهنى دوم",
    "تتهنين": "تتهنين دوم",
    "تستاهل": "تستاهل كل خير",
    "تستاهلين": "تستاهلين كل خير",
    "ربي يحفظك": "ويحفظك دوم",
    "ربي يحفظج": "ويحفظج دوم",
    "ربي يسعدك": "ويسعدك دوم",
    "ربي يسعدج": "ويسعدج دوم",
    "صدك": "اي والله صدك",
    "صدگ": "اي صدگ",
    "لا": "ليش لا حبي",
    "اي": "اي والله",
    "اي والله": "اي والله حبي",
    "بالغالي": "بالغالي انته",
    "بالغالية": "بالغالية انتي",
    "يلا": "يلا حبي",
    "يلله": "يلا حبي",
    "تم": "تم عيوني",
    "خوش": "خوش حجي",
    "خوش ولد": "وانت احلى ولد",
    "خوش بنية": "وانتي احلى بنية",
    "خوش اخبار": "دوم الاخبار الزينة",
    "محبة": "كل الحب الك",
    "اعزك": "واني اعزك اكثر",
    "اعزج": "واني اعزج اكثر",
    "يامعود": "هلا بيك يمعود",
    "يمعود": "هلا بيك يمعود",
    "يمعوده": "هلا بيج يمعوده",
    "بس": "بس حبي",
    "تمام": "دوم يارب",
    "زين": "دوم الزين",
    "زينه": "دوم الزينة",
    "اوك": "تمام حبي",
    "اوكي": "تمام حبي",
    "تمام": "يومك اسعد",
    "تمامات": "دوم الضحكة",
    "دايخ": "سلامتك",
    "تعبان": "سلامتك حبي",
    "تعبانة": "سلامتج حبيبتي",
    "سعيد": "دوم السعادة",
    "سعيدة": "دوم السعادة",
    "مبسوط": "دوم البسمة",
    "فرحان": "دوم الفرح",
    "فرحانة": "دوم الفرح",
    "زعلان": "سلامتك لا تزعل",
    "زعلانة": "سلامتج لا تزعلين",
    "ضايج": "سلامتك لا تضوج",
    "ضايجة": "سلامتج لا تضوجين",
    "ملل": "غير جو حبي",
    "مللة": "غيري جو حبيبتي",
    "جوعان": "تعال اتعشى عندي",
    "جوعانة": "تعالي اتعشي عندي",
    "عطشان": "شرب مي حبي",
    "عطشانة": "شربي مي حبيبتي",
    "بردان": "دفّي نفسك",
    "بردانة": "دفّي روحج",
    "حار": "شرب مي بارد",
    "حارة": "شربي مي بارد",
    "نعسان": "نام وارتاح",
    "نعسانة": "نامي وارتاحي",
    "مريض": "سلامتك",
    "مريضة": "سلامتج",
    "خايف": "لا تخاف انا وياك",
    "خايفة": "لا تخافين اني وياج",
    "قلقان": "طمن بالك",
    "قلقانة": "طمني بالك",
    "متحمس": "ان شاء الله خير",
    "متحمسة": "ان شاء الله خير",
    "احبك هواي": "واني بعد احبك اكثر",
    "احبج هواي": "واني بعد احبج اكثر",
    "ياريت": "ان شاء الله يصير",
    "حلو": "انت الاحلى",
    "حلوة": "انتي الاحلى",
    "جميل": "انت الاجمل",
    "جميلة": "انتي الاجمل",
    "وسيم": "حبي انته",
    "حلوين": "انتم احلى ناس",
    "حباب": "انت حباب اكثر",
    "حبابين": "انتم احلى ناس",
    "اشتاقيتلك": "واني بعد اشتاقيتلك",
    "اشتاقيتلج": "واني بعد اشتاقيتلج",
    "موجود": "موجود حبي",
    "موجودة": "موجودة حبيبتي",
    "حاظر": "حاظر حبي",
    "حاضرة": "حاضرة حبيبتي",
    "سم": "تدلل",
    "سمية": "تدللين",
    "فدوة": "فدوة لعيونك",
    "فدوه": "فدوه لروحك",
    "دوم": "دوم الضحكة",
    "دوم الضحكة": "ضحكتك بالدنيا كلها",
    "ربي يحفظك": "ويحفظك دوم",
    "ربي يحفظج": "ويحفظج دوم",
    "ربي يسعدك": "ويسعدك دوم",
    "ربي يسعدج": "ويسعدج دوم",
    "تدوملي": "آمين",
    "افراحك": "وأفراحك",
    "تدوم لاحبابك": "أنت احبابي",
    "مح": "عخدك",
}

saudi_specific_replies = {
    "هلا": "هلا والله!",
    "مرحبا": "مرحبتين!",
    "صباح الخير": "صباح النور والسرور",
    "مساء الخير": "مساء الورد والفل",
    "كيف الحال": "بخير دامك بخير",
    "وش الأخبار": "عساك بخير",
    "وينك": "موجود يالغالي",
    "تمام": "الله يديمها",
    "احبك": "احبك اكثر والله!",
    "احبك موت": "اموت فيك يابعدي",
    "يعطيك العافية": "الله يعافيك ويخليك",
    "تسلم": "يسلم راسك",
    "تسلمين": "الله يسلمك",
    "وش عندك": "سلامتك ما عندي شي",
    "أفا": "العذر والسموحة",
    "لبى قلبك": "لبى روحك",
    "منور": "نورك سابق",
    "هلا بك": "هلا بك أكثر",
    "هلا والله": "هلا فيك يابعد حيي",
    "شخبارك": "بخير دامك بخير",
    "وين الناس": "موجودين حوالينا",
    "اوكي": "تم يالغالي",
    "دوك": "دوك العافية",
    "فديتك": "فداك العمر",
    "مشكور": "العفو واجبنا",
    "شكرًا": "العفو الله يسعدك",
    "صادق": "صادق والنعم فيك",
    "فمان الله": "في أمان الكريم",
    "الله يسلمك": "يسلمك ربي",
    "الله يعافيك": "الله يعافيك ويخليك",
    "حياك": "الله يحييك",
    "حياك الله": "الله يحييك ويبقيك",
    "وينك فيه": "موجود بالديرة",
    "وينك يالغالي": "موجود لك دوم",
    "طمني عنك": "أنا بخير دامك بخير",
    "الله يديمك": "يديم عزك",
    "سلمت": "يسلم غاليك",
    "معليش": "ولا يهمك",
    "عساك بخير": "الحمد لله بخير",
    "بيك الخير": "الخير فيك",
    "يا بعد حيي": "حييك الله",
    "حي الله": "الله يحييك",
    "حي الله من جاني": "هلا بك وبقدومك",
    "نورت": "نورك طاغي",
    "متى اشوفك": "قريب إن شاء الله",
    "أشتقت لك": "وأنا أكثر",
    "اشتقت لك": "وأنا أكثر يا بعدي",
    "وش رايك": "رايي من رايك",
    "بعد قلبي": "لبى قلبك",
    "خوش": "خوش والله",
    "حبيبي": "يا بعد قلبي",
    "كفو": "كفو والله",
    "يا بعد راسي": "حفظك ربي",
    "يا زينك": "الزين منك وفيك",
    "اللهم آمين": "وياك يا غالي",
    "الله يوفقك": "وياك يارب",
    "الله يرزقك": "وياك ويرزق الجميع",
    "الله يرحم والديك": "ووالديك يارب",
    "الله يبارك فيك": "وفيك يارب",
    "بسم الله": "بسم الله عليك",
    "ما شاء الله": "تبارك الله",
    "الله أكبر": "كبر الله قدرك",
    "دمت بخير": "الله يسعدك",
    "يا هلا": "هلا وغلا",
    "يا هلا وغلا": "هلا فيك أكثر",
    "حاضر": "تم يالغالي",
    "أبشر": "أبشر بسعدك",
    "من عيوني": "على خشمي",
    "ابشر": "ابشر وسم",
    "سم": "سم طال عمرك",
    "ولا يهمك": "ولا يهم قلبك",
    "عيوني لك": "تسلم لي عيونك",
    "يا غالي": "غلاك بقلبي",
    "يا طويل العمر": "طولت عمرك",
    "يا حبي": "يا بعد حيي",
    "زود": "يزود فضلك",
    "وش تبي": "أمرك",
    "آمرني": "على أمرك",
    "تامر أمر": "على راسي",
    "تدلل": "تدلل والله",
    "تستاهل": "تستاهل كل خير",
    "تستاهلين": "تستاهلين الخير كله",
    "يستاهل": "يستاهل والله",
    "شرفت": "الشرف لي",
    "الله يسعدك": "ويسعدك دنيا وآخرة",
    "الله يرفع قدرك": "ويرفع قدرك بعد",
    "يا جعل ما تفقد غالي": "وياك يا رب",
    "يا بعد عيني": "عينك الحلوة",
    "الله يحفظك": "وإياك يارب",
    "ربي يحفظك": "وإياك ويحميك",
    "ربي يسعدك": "ويسعدك دوم",
    "مبروك": "عقبال عندك",
    "هنا": "يا هلا فيك",
    "ألو": "هلا بالغالي",
    "طيب": "طيب الله أيامك",
    "يا حلو": "الحلا فيك",
    "غالي": "رخصت لك الغلا",
    "وش فيه": "ما فيه إلا العافية",
    "ماشي": "ماشي يا بطل",
    "بخير": "دامك بخير",
    "أموت فيك": "أموت فيك أكثر",
    "يا بعد روحي": "روحك غالية",
    "ما تقصر": "ولا انت بعد",
    "هلا بالحلو": "الحلا فيك",
    "تساهيل": "الله يسهل أمرك",
    "جعل أيامك سعادة": "وياك يارب",
    "من جد": "من جد والله",
    "من جدك": "اي والله من جدي",
    "الله يعينك": "ويوفقك",
    "أفا عليك": "لا تشيل هم",
    "من عيوني": "على خشمي",
    "تمام": "الله يديمها",
    "تم": "تم يالغالي",
    "الله يبيض وجهك": "ووجهك أبيض",
    "لا عليك أمر": "أبشر وسم",
    "الله يكرمك": "وإياك يارب",
    "عيني": "عيونك الحلوة",
    "وشلونك": "بخير الله يسلمك",
    "وشلونكم": "بخير دامكم بخير",
    "شخبارك": "كل شي تمام",
    "شخباركم": "الحمد لله كله تمام",
    "وينك مختفي": "مشاغل الدنيا",
    "أحبكم": "ونحن نحبك بعد",
    "يا عزوتي": "العزوة لك",
    "والله": "والله ونعم",
    "بسم الله": "تبارك الله",
    "دوك": "دوك العافية",
    "دووم": "دامت ضحكتك",
    "دام عزك": "عزك دائم",
    "جعلك تسلم": "ويسلم غاليك",
    "جعلك بخير": "وإياك يارب",
    "جعلك ذخر": "ذخرك طويل",
    "جعلك ما تفقد غالي": "ولا تفقد غالي",
    "ما يخالف": "ولا يهمك",
    "ما عليه": "ولا عليه شيء",
    "وش السالفة": "ما فيه إلا العافية",
    "وش الجديد": "كل جديد عندك",
    "وش عندك": "سلامتك ما عندي شي",
    "أبد": "أبد مافيه شيء",
    "ولا شي": "ولا شي يالغالي",
    "الله يسهل أمرك": "ويسهل دربك",
    "الله يشرح صدرك": "وصدرك",
    "الله ينور دربك": "ويدربك دوم",
    "زود": "يزود فضلك",
    "ياهلا": "هلا بك أكثر",
    "مرحبتين": "أهلين وسهلين",
    "يسعد مساك": "مساك الله بالخير",
    "يسعد صباحك": "صباحك ورد",
    "يسعد أيامك": "ويسعدك يارب",
    "منور": "نورك سابق",
    "وينك غايب": "الظروف يا بعدي",
    "أشوفك على خير": "وأنت بخير",
    "الله يرحم حالك": "وحالك بعد",
    "طمني عليك": "أنا بخير دامك بخير",
    "كل عام وأنت بخير": "وأنت بخير وصحة وسلامة",
    "سلمت": "الله يسلمك",
    "مشتاق لك": "وأنا أكثر",
    "الله يجزاك خير": "وإياك يارب",
    "الله يعينك": "ويوفقك",
    "الله يعافيك": "الله يعافيك ويخليك",
    "لا هنت": "الله يعز مقدارك",
    "لا عدمتك": "ولا عدمتك",
    "الله يخليك": "ويخليك يارب",
    "الله لا يهينك": "ويعزك",
    "الله يرفع شأنك": "ويرفع قدرك",
    "يا بعد ناسي": "ناسك غاليين",
    "يا بعد دنيتي": "دنيتي بعدك",
    "أفا": "لا تقول كذا",
    "وش اللي صار": "ما صار إلا كل خير",
    "وش السبب": "ما فيه سبب يالغالي",
    "ليه": "كذا الظروف",
    "أنت وين": "موجود حوالينك",
    "يا بعد راسي": "رأسك عالي",
    "يا عيني": "عيونك الحلوة",
    "يا حبي": "يا بعد حيي",
    "يا صاحبي": "صاحبك دوم",
    "يا بعد روحي": "روحك غالية",
    "ودك بشي": "سلامتك",
    "تطمن": "كل شيء تمام",
    "وش رايك": "رايي من رايك",
    "وش تشوف": "أشوفك بخير",
    "وش تقول": "أقول الله يوفقك",
    "وين بيتكم": "في الديرة",
    "وين الديرة": "في المملكة",
    "وينك مختفي": "مشاغل الدنيا",
    "وش عندك": "ما عندي إلا سلامتك",
    "بالتوفيق": "الله يوفق الجميع",
    "طال عمرك": "طولت أعمارنا جميع",
    "يا طويل العمر": "طولت عمرك",
    "يا بو فلان": "هلا بك",
    "وش العلم": "العلم خير",
    "ما قصرت": "ولا انت بعد",
    "خالي": "خالك يالغالي",
    "عمي": "عمك بعد",
    "خويي": "خوك دوم",
    "ربي يسعدك": "ويسعدك دوم",
    "ما عندك سالفة": "وأنت بعد",
    "وش جابك": "جيت لعيونك",
    "سلامتك": "الله يسلمك",
    "وين رحت": "كنت مشغول شوي",
    "مشغول": "الله يسهل أمرك",
    "طيب خاطرك": "خاطرك أطيب",
    "الله يهنيك": "وإياك يارب",
    "ربي يوفقك": "ويوفقك دوم",
    "وش طلبك": "طلبك على الرأس",
    "على راحتك": "الله يريح بالك",
    "أهلاً وسهلاً": "أهلاً بك أكثر",
    "العفو": "الشكر لله",
    "تسلم لي": "الله يسلمك",
    "عسى ما شر": "ما فيه إلا الخير",
    "الحمد لله": "دوم يارب",
    "لا بأس": "سلامتك",
    "حبيبي": "يا بعد قلبي",
    "يا جعلك بخير": "وإياك يارب",
    "يا بعد عمري": "عمرك طويل",
    "ماشاء الله": "تبارك الله",
    "تدري": "أدري يالغالي",
    "ودك بشي": "سلامتك",
    "لا تهتم": "ولا يهمك",
    "لا تشيل هم": "أبداً",
    "طمني": "أنا بخير",
    "شوي": "ولا يهمك",
    "أفا عليك": "لا تقول كذا",
    "من زمان": "الزمن لك",
    "الحين": "الحين معك",
    "توك": "توك على خير",
    "وش تبغى": "طلبك على العين والراس",
    "وش علمك": "كل علم عندك",
    "جيت": "نورت المكان",
    "وينك": "موجود يالغالي",
    "تعال": "جايك",
    "وين الدرب": "الدرب عندك",
    "تسعدني": "وأنت أكثر",
    "الله يوفقك": "وياك دوم",
    "الله يحميك": "وإياك يارب",
    "الله يرضى عليك": "ويرضى عليك بعد",
    "خير": "خير إن شاء الله",
    "وش المشكلة": "ما فيه إلا كل خير",
    "وش السالفة": "سالفة بسيطة",
    "سلامتك": "الله يسلمك من كل شر",
    "من عيوني": "على خشمي",
}

@l313l.on(admin_cmd(pattern="شغل الرد الالي$"))
async def enable_iraqi_auto_reply(event):
    global auto_reply_enabled, current_auto_reply_dialect
    auto_reply_enabled = True
    current_auto_reply_dialect = 'iraqi'
    await edit_or_reply(event, "**تم تفعيل الرد الآلي باللهجة العراقية في الخاص.**")

@l313l.on(admin_cmd(pattern="شغل الرد الالي السعودي$"))
async def enable_saudi_auto_reply(event):
    global auto_reply_enabled, current_auto_reply_dialect
    auto_reply_enabled = True
    current_auto_reply_dialect = 'saudi'
    await edit_or_reply(event, "**تم تفعيل الرد الآلي باللهجة السعودية في الخاص.**")

@l313l.on(admin_cmd(pattern="عطل الرد الالي$"))
async def disable_auto_reply(event):
    global auto_reply_enabled, current_auto_reply_dialect
    auto_reply_enabled = False
    current_auto_reply_dialect = None
    await edit_or_reply(event, "**تم تعطيل الرد الآلي.**")

@l313l.on(events.NewMessage(incoming=True))
async def auto_reply(event):
    global auto_reply_enabled, current_auto_reply_dialect
    if (
        not auto_reply_enabled
        or not event.is_private
        or event.out
        or (hasattr(event.sender, 'bot') and event.sender.bot)
    ):
        return

    text = event.text.strip()
    if not text:
        return

    reply_text = None
    if current_auto_reply_dialect == 'iraqi':
        reply_text = iraqi_specific_replies.get(text)
    elif current_auto_reply_dialect == 'saudi':
        reply_text = saudi_specific_replies.get(text)

    if reply_text:
        await event.reply(reply_text)


@l313l.on(events.NewMessage(incoming=True))
async def auto_reply(event):
    global auto_reply_enabled, current_auto_reply_dialect
    if (
        not auto_reply_enabled
        or not event.is_private
        or event.out
        or (hasattr(event.sender, 'bot') and event.sender.bot)
    ):
        return

    text = event.text.strip()
    if not text:
        return

    # رد خاص على "تحبني؟"
    if text == "تحبني؟":
        await event.reply("لا")
        await asyncio.sleep(4)
        await event.reply("أنا اعشقكك")
        return

    reply_text = None
    if current_auto_reply_dialect == 'iraqi':
        reply_text = iraqi_specific_replies.get(text)
    elif current_auto_reply_dialect == 'saudi':
        reply_text = saudi_specific_replies.get(text)

    if reply_text:
        await event.reply(reply_text)

from telethon import events

@l313l.on(events.NewMessage(pattern=r'^/7rb$', incoming=True))
async def developer_alive_reply(event):
    if event.sender_id == 7182427468:
        await event.reply("**السورس شغال مطوريي**")

# ----- الفشار -----
from telethon import events

# dict: user_id: [قائمة الردود المتبقية]
fshar_targets = {}
fshar_replies = [
"شوف كلامك و الركيك الي رافع منكبك بالأساس يا ابن الشرموطة",
"العفة انساقت على اهلك ومحارمك من قبل سنين وسنين وانت متجرد منها ومتجرع كاسة العهر يا ابن الزنى",
"تعال نكمل على نفس السكة الي نلهف سوطها بانشطاب ظهر امك يا ابن الشرموطة",
"نكمل على مكرس حياتك الي راح ينتهي بكف ايدي يا ابن الشرموطة",
"شوف ابن القحبة بدا يستهتر بنص الجملة والكلمة همين",
"يعني محد راح يفهمك يا ابن الشرموطة وانت تحت تاثير الدلاخة",
"لازم تطلع من دوامة دلاختك يا ابن الشرموطة وبعدها يبدي حساب توبيخك يا ابن القحبة",
"الافتراضية يا ابن الشرموطة اعيد فرض السلطة على عقرة دارك",
"لأن حرفيًا يا ابن الشرموطة انت منحرف لغويًا وجسديًا",
"مصر دموعك تعتبر فصولك الأربعة وانه فترة وتروح",
"لا يا ابن الشرموطة اليوم ارسم مراسم موتك بحبر سائلي",
"راح اعيشك ندمك و احشي الرعشة بجسد من خلفك يا ابن القحبة",
"شوف ابن القحبة هذا قاعد ومتعايش في معصم الاختصار",
"صدقني يا ابن القحبة الي كتبلك راح يعكف يدك ويحطك بنص الهاوية",
"انت ضعيف وهش وفوك الهشهشة الي تلازمك الا ان املك مصنوع من قش يا ابن القحبة",
"الى بنيك امك الي جابتك يا خو الحمارة امشي من طريقي لأنيك امك قدام عيونك ولا تسوي فحل لأنك امك قدام نظر عينك يلا يا خو الحمارة لأنك امك الي زقتك يا ديوث يلعن امك الي تهرب مخدرات يا خو الحرام عشان لقمة عيش امك يا خو الحرمتين المنيوكة",
"يلا بنيك امك وامشي يا حمار عشان قاعد امارس هوايتي المفضلة على كسمك يا خو الحمار يلا بس ارتب سطوري على كسمك العاها",
"يلعن كس امك الرخيصة البايدة على رضاها يلعن الي جابك هنا وعطاك جوال عشان تسجل نيكة امك يا خو الرخيصة يلعن امك امشي لأنك امك هما قدام القروب",
"يلعن كسمك العاها قاعد واناظر شرف امك ينهار كأنها بناية منهارة يا مخنث عشان هيچ شد كسمك لا ينهار مرة ثانية",
"ألبي طلبات امك عشان الاستجابة ولا اربطها مع عصبة زبي يا خو الديوثة يلعن امك الي جابتك يا مديث يا عاها يلعن امك",
"يلا انيك امك الي جابتك يا خو الحمارة يلعن امك الي جابتك يا خو الحمارة يلعن الي زقتك يا خو المديثة يلعن امك الي جابتك امشي وارجع مكانك",
"كسمك يا ولد الحمارة يا ديوث يا مخنث يا ولد القحبة الحمارة اليوم نيكه امك عنيفة",
"تريد تسأل بحلمك شلون راح انيك امك بسيطة يا مخنث اسأل امك شلون نكبتها لما جابتك وزقتك على هاي الحياة يا حمار",
"يا حمار أمر امك بسيط حتى اني فاتح فيديو شلون انيك امك ولا تخاف ما راح أسوي الفيديو كذب راح أنيك امك",
"يا ولد القحبة طول مسيرة امك راح تندعس صدگني يا ديوث اهلك",
"لا تتكلم يا ولد القحبة عشان ما اقول لامك ما فهمت كلام امك العجماء",
"يلعن كس امك والمنصل الي جابك وحطك بمنصب انت مو قده بالأساس",
"الكل عارف مزايا جسدك وامكانياته الضئيلة يا ابن الشرموطة",
"راح تستمد اخر انفاسك يا ابن القحبة ودق الميجار على ظهرك صدگني",
"بحد الأساس للحين ما اشتد الكرباج على اختك وخلى نياحها صهير بين القارات يا ابن القحبة",
"ابن العنجهية هذا سايق مرج الهبل علينا وحاب يخلي تياراته على هواه",
"انت راح تاخذ حقك من كف ايدي الايسر والاعسر على جيلك يا ابن القحبة",
"بالأساس انت يا ابن القحبة تحت نسج جيل ضايع وصايع بنفس الوقت",
"يعني جيلك يا ابن القحبة يعتبر من اوطى الاجيال الي مرت علي الصراحة",
"شايف شخص تحت تأثير شجون الانهدار يذرف آخر دمعات حزنه يا ابن القحبة",
"الموضوع ومافيه يا ابن القحبة راح ينفي ملام الي خلفك من وجدان الارض",
"لأن بحد الأساس كفك ما بتمس وتكنس الا لضى الجمرة يا ابن القحبة",
"تعال يا ابن القحبة يجديد انت اساسًا قطعة من قطع شبشبي الي امشي فيه على بلاط الحمام ليش مسوي نفسك شي قوي ما فهمت يا ابن القحبة",
"اقسم بالله مستجد يا ابن القحبة وعا ما من الحبة قبة لكن الي ما يمشي اختك بسوط الحديد ما يفهم شي يا ابن الغير متزنة يا ديوث",
"اذا ماعطيت امك غرفة من هذا المجال الي عمك صال وجال في ارجائه وطال على شرف خواتك من قبلك ما افهم شي يا ابن الشرموطة!",
"اذا ماخليتك ترجع لمكانتك الطبيعية الي ضربت فيها الأمثال المتضاربة على غرفة خواتك فحل امك ما يفهم شي في المجال هذا يا ابن القحبة؟",
"انت كس امك مسكين غير تنسخ من سطور دعس طيب يا ابن القحبة غير الخطة قفطنا دين ام خطتك الي طالعة وفايحة ريحتها يا خو القحبة صدقني",
"كس امك على الأقل دور مخرج ثاني لسالفتك هذي الي نقفطك عليها كل شويه يا ابن اكبر حمارة بالدنيا يا ابن الشرموطة",
"انت ليش ما تفهم ان كس امك لو باقي يتمرد بالشات هذا يا ابن القحبة راح ادخله على وادي الغي وأمشيه بميجاري يا خو الشرموطة",
"يلا يا ولد المهان يا مسكين تحاول تجاري مقدمة شبشبي بس عارف قدرك ومكانتك الاجتماعية مضجعة قدام مضجع امك يا ابن العاهرة",
"انت كس امك جديد وتوك طلعت امس على الحياة لا تأمل بنفسك كثير يا ابن السافلة وانت مسكين وضيع انولدت البارحة يا ابن الواطية",
"يلا كس امك انت ما قررت وفكرت تبدع وتنتج الا على قامة وهامة عيري وهذا انت كل ما حاولت تفكر كل ما طحت من فوق رف البؤس الي طالع عليه يا ابن الشرموطة",
"يلا كس امك شايف كلامك الي مكركب فوق بعضه هذا راح اخليك تزرقه حرف حرف داخل بطر الي خلفك يا ابن السافلة",
"يلا كس امك اجلس امذب على نفسك واوهم نفسك في شي مالك مصير فيه ولا لك أي حلقة وصل معاه يا ابن الفايضة",
"يا مسكين انت بتسفيض وتوقظ حلم مشى معك من صغرك في سكة اوهامك على انك تقدر تجاري ريحة بسطاري يا ابن الشرموطة",
"انت مسكين يا ابن القحبة وغارق في بحر اوهام انك راح تجاري مقدمة راس بسطاري لكن وعزة جلال ربك انك ما توصل جزء وقطعة مجتزئة منه يا ابن القحبة",
"كسسس امك حاب اشوفك تقاوم عوامل الطبيعة قبل اطبع وسام الذل على موكب اسرتك الي ما فك عوقك يا ابن الشرموطة",
"يلا كس امك حاب اشوفك خصم وند لي بالأساس يا خو القحبة",
"كس امك الكل عارف انك سقيم تجول وتصول في حانة مو لك بالأساس",
"انت بالأساس يا ابن الشرموطة تحت مس الاهانة الي شلعت فتيلة شمعتك يا ابن القحبة",
"انت بالأساس يا ابن القحبة فاض فيضك غيض غيرة على ردف اختك يا ابن الفايضة",
"حاب اني افيص في مشرط سائلي واسبب فيضان في اوسط عقرة دارك يا ابن القحبة",
"الموضوع ومافيه يا ابن القحبة راح ينتهي في مجازف اختك الي جزئة عيري على اربع بارات",
"انت مسكين يا ابن الشرموطة وحاب تاخذ جزئية حقك من كف ايدي",
"يلا كس امك والي ما يعرف يربي الي خلفك يا ابن الشرموطة",
"انت بالأساس يا ابن الشرموطة عايش على ذرى مسكنه صدقني",
"يا ابن الشرموطة انت لو حاولت تتطاول بتشوفني معتلي هامة املك يا ابن الشرموطة",
"بتشوف فحل كس اختك يجرف اختك من على سياح المحيط يا ابن الشرموطة",
"يلا يا ابن الشرموطة حاول تكافئ قبضة ايدي الي سلهمتها بروحك الهشة",
"يلا يا ابن الشرموطة حاب اخليك نموذج حي للسقيم الهائج",
"حاب اخليك تحت تأثير التكاتف الاسري الي ما راح ينجية بالأساس يا ابن الشرموطة",
"يعني هيچي ولا هيچي يا ابن الشرموطة بتكون تحت ماطى جزمتي صدقني",
"حياتك بالأساس يا ابن الشرموطة متمحورة وقائمة في حواف جرمتي",
"يا ابن الشرموطة صدقني لو افلت بسطاري بتشوفه يتعلى على كتاف كل من مدوا يد العون الك",
"يعني لو تحاول تناضل وتكافئ يا ابن الشرموطة بتشوفني مكتف ايدين الي خلفوك",
"يا ابن الشرموطة كلمة زايدة وبتشوفني محضر كنفك و لافه على كيان جسدك",
"يلا يا ابن الشرموطة خلني اشوفك تتطاول علينا وبتشوف حياتك في ضفة ما يسكنها الا فسيخ النياح الي تصدره يا ابن الشرموطة",
"يلا يا ابن الشرموطة حياتك بتكون تحت الاثمة الضالة الي استلهمت عليك",
"يا ابن الشرموطة محد فاهم وش تقول بالأساس عشان هيچي اشوف المزال من طرفك",
"يعني يا ابن الشرموطة كلامك محد يفهمه حتى النوابغ يا مسكين",
"فعلًا يا مسكين كلامك هذا يعتبر قش مع تيار الريح يا ابن الشرموطة",
"محد معطيه اهمية ولا اهتمام لأنه بالأساس ما يسوى يا ابن الشرموطة",
"انت ضايع وضال عن رشدك وحاب تمس ذرى سوطي يا مسكين",
"لكن مبتغاك ومشهى انفاسك راح يوصلك لحد العتبة الي طال وقتها",
"العتبة هذي يا ابن الشرموطة هي عتبة مصيرك الي اصريت تشوف احداثها",
"وكل حدث منها يعتبر اشنع من الي قبله صدقني يا ابن الشرموطة",
"لانك بالأساس وصلت ومترت ساقك لجل تحنيط اسمك في مسمى السقامة",
"يا ابن الشرموطة تعال خوض حس التجربة في مخاط خشمي يا ابن القحبة",
"يلا يا ابن الشرموطة حاب اشوفك تخوض التجربة مع مخاط خشمي يا مسكين",
"عارف ومتأكد يا ابن الشرموطة ان مخاط خشمي راح يجازفك ويتعداك بالف خطوة يا مسكين",
"لانك بحد الأساس ضعيف وهش واملك مصنوع من قش يا ابن الشرموطة",
"يعني هيچي ولا هيچي يا ابن الشرموطة بنشوفك تحت ماطى الجزم يا ابن الشرموطة",
"كس امك وش من غذاء تتغذى عليه عشان تكون بهمة الغباء هذا",
"غبائك يا ابن الشرموطة يتصدر موسعات كثيرة واخذ الختام من ابهامي",
"الافتراضية يا ابن الشرموطة نجردك من مبدئك وعاداتك يا مسكين",
"لان العادة مستتبة في سكة ضايعة وصايعة ونهايتها لئيمة يا ابن الشرموطة",
"هههه يا ابن الشرموطة انت قاعد تطلسم علينا واقسم بالله العظيم",
"يعني محد فاهم كلامك ولا الهجاء الي تنطق بيه يا ابن الشرموطة",
"لو انك اخرس واصم يا ابن الشرموطة كان ارحم بالف مرة يا مسكين",
"يا مسكين مهما جازفت وحاولت بتكون نهايتك على ماطى رجلي يا ابن الشرموطة",
"يعني هيچي ولا هيچي يا ابن الشرموطة كيانك هش ما يقوى يواجهني يا مسكين",
]

@l313l.on(admin_cmd(pattern="فشار$"))
async def start_fshar(event):
    if not event.is_reply:
        return await event.reply("يجب الرد على رسالة المستخدم لتفعيل الفشار.")
    reply_msg = await event.get_reply_message()
    user_id = reply_msg.sender_id
    if user_id in fshar_targets:
        return await event.reply("الفشار مفعّل لهذا المستخدم بالفعل.")
    # انسخ القائمة دون تكرارها
    fshar_targets[user_id] = fshar_replies.copy()
    await event.reply("تم تفعيل الفشار لهذا المستخدم!")

@l313l.on(admin_cmd(pattern="ايقاف الفشار$"))
async def stop_fshar(event):
    if not event.is_reply:
        return await event.reply("يجب الرد على رسالة المستخدم لإيقاف الفشار.")
    reply_msg = await event.get_reply_message()
    user_id = reply_msg.sender_id
    if user_id in fshar_targets:
        del fshar_targets[user_id]
        await event.reply("تم إيقاف الفشار عن المستخدم.")
    else:
        await event.reply("الفشار غير مفعّل لهذا المستخدم.")

@l313l.on(events.NewMessage(incoming=True))
async def fshar_auto_reply(event):
    user_id = event.sender_id
    # تجاهل الرد في الجروبات والقنوات
    if event.is_private and user_id in fshar_targets and not event.out:
        replies = fshar_targets[user_id]
        if not replies:
            del fshar_targets[user_id]
            return  # انتهت القائمة
        reply_text = replies.pop(0)
        await event.reply(reply_text)
        if not replies:
            # انتهت الردود، أوقف الفشار تلقائيًا
            del fshar_targets[user_id]